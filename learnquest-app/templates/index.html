<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnQuest - K-12 Learning Adventure</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶â</text></svg>">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav id="main-nav" class="hidden">
            <div class="nav-left">
                <div class="logo" onclick="App.navigate('home')">
                    <svg class="owl-icon" viewBox="0 0 40 40" width="32" height="32">
                        <circle cx="20" cy="20" r="18" fill="#4A90D9"/>
                        <circle cx="14" cy="16" r="5" fill="white"/>
                        <circle cx="26" cy="16" r="5" fill="white"/>
                        <circle cx="14" cy="16" r="2.5" fill="#333"/>
                        <circle cx="26" cy="16" r="2.5" fill="#333"/>
                        <polygon points="20,20 17,24 23,24" fill="#F39C12"/>
                        <path d="M8,10 Q12,4 16,10" fill="#4A90D9" stroke="#3a7bc8" stroke-width="1"/>
                        <path d="M24,10 Q28,4 32,10" fill="#4A90D9" stroke="#3a7bc8" stroke-width="1"/>
                    </svg>
                    <span class="logo-text">LearnQuest</span>
                </div>
            </div>
            <div class="nav-center">
                <button class="nav-btn" onclick="App.navigate('home')" data-page="home">Home</button>
                <button class="nav-btn" onclick="App.navigate('subjects')" data-page="subjects">Subjects</button>
                <button class="nav-btn student-only" onclick="App.navigate('tutor')" data-page="tutor">AI Tutor</button>
                <button class="nav-btn student-only" onclick="App.navigate('ai-studio')" data-page="ai-studio">AI Studio</button>
                <button class="nav-btn student-only" onclick="App.navigate('flashcards-home')" data-page="flashcards-home">Flashcards</button>
                <button class="nav-btn" onclick="App.navigate('badges')" data-page="badges">Badges</button>
                <button class="nav-btn teacher-only" onclick="App.navigate('teacher')" data-page="teacher">Dashboard</button>
            </div>
            <div class="nav-search">
                <input type="text" id="nav-search-input" placeholder="Search lessons..." class="search-input-nav" onkeyup="App.handleSearch(event)" onfocus="App.showSearchResults()" onblur="setTimeout(()=>App.hideSearchResults(),200)">
                <div id="search-results-dropdown" class="search-dropdown hidden"></div>
            </div>
            <div class="nav-right">
                <div class="xp-display" id="nav-xp">
                    <span class="xp-icon">‚≠ê</span>
                    <span class="xp-value" id="nav-xp-value">0</span> XP
                </div>
                <div class="streak-display" id="nav-streak">
                    <span class="streak-icon">üî•</span>
                    <span class="streak-value" id="nav-streak-value">0</span>
                </div>
                <div class="user-menu" id="nav-user" onclick="App.toggleUserMenu()">
                    <span class="avatar-small" id="nav-avatar">ü¶â</span>
                    <span id="nav-username">Student</span>
                </div>
                <div class="user-dropdown hidden" id="user-dropdown">
                    <button onclick="App.navigate('profile')">My Profile</button>
                    <button onclick="App.toggleDarkMode()">Toggle Dark Mode</button>
                    <button onclick="App.logout()">Logout</button>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content">
            <!-- Pages are rendered here by the SPA router -->
        </main>

        <!-- AI Tutor Chat Panel -->
        <div id="tutor-panel" class="tutor-panel hidden">
            <div class="tutor-header">
                <div class="tutor-title">
                    <svg class="owl-icon" viewBox="0 0 40 40" width="24" height="24">
                        <circle cx="20" cy="20" r="18" fill="#4A90D9"/>
                        <circle cx="14" cy="16" r="5" fill="white"/>
                        <circle cx="26" cy="16" r="5" fill="white"/>
                        <circle cx="14" cy="16" r="2.5" fill="#333"/>
                        <circle cx="26" cy="16" r="2.5" fill="#333"/>
                        <polygon points="20,20 17,24 23,24" fill="#F39C12"/>
                    </svg>
                    <span>Learning Buddy</span>
                </div>
                <button class="tutor-close" onclick="Tutor.toggle()">‚úï</button>
            </div>
            <div class="tutor-messages" id="tutor-messages"></div>
            <div class="tutor-input-area">
                <input type="text" id="tutor-input" placeholder="Ask me anything..." onkeypress="if(event.key==='Enter')Tutor.send()">
                <button onclick="Tutor.send()" class="tutor-send-btn">Send</button>
            </div>
        </div>

        <!-- Tutor toggle button -->
        <button id="tutor-toggle" class="tutor-fab hidden" onclick="Tutor.toggle()">
            <svg viewBox="0 0 40 40" width="28" height="28">
                <circle cx="20" cy="20" r="18" fill="white"/>
                <circle cx="14" cy="16" r="5" fill="#4A90D9"/>
                <circle cx="26" cy="16" r="5" fill="#4A90D9"/>
                <circle cx="14" cy="16" r="2.5" fill="#333"/>
                <circle cx="26" cy="16" r="2.5" fill="#333"/>
                <polygon points="20,20 17,24 23,24" fill="#F39C12"/>
            </svg>
        </button>

        <!-- Confetti canvas for celebrations -->
        <canvas id="confetti-canvas"></canvas>

        <!-- Toast notifications -->
        <div id="toast-container"></div>

        <!-- Confirmation Modal -->
        <div id="confirm-modal" class="modal-overlay hidden">
            <div class="modal-card">
                <p id="confirm-message"></p>
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="App.closeConfirm(false)">Cancel</button>
                    <button class="btn btn-primary" id="confirm-ok-btn">OK</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer id="app-footer" class="app-footer hidden">
            <div class="footer-content">
                <p class="footer-slogan">Learn Without Limits &mdash; Free Education for All</p>
                <p class="footer-credit">Created by <strong>Diamond Bar High School Vibe Coding Club</strong></p>
                <div class="footer-links">
                    <a href="#" onclick="App.navigate('about');return false;">About</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Minimal QR Code generator (no external deps) -->
    <script>
    const QRCode={generate:function(t,e){const n=this._encode(t);if(!n||!e)return;const o=document.createElement('canvas'),r=n.length,s=Math.max(4,Math.floor(200/r));o.width=o.height=r*s;const c=o.getContext('2d');c.fillStyle='#fff';c.fillRect(0,0,o.width,o.height);c.fillStyle='#000';for(let i=0;i<r;i++)for(let j=0;j<r;j++)if(n[i][j])c.fillRect(j*s,i*s,s,s);e.innerHTML='';e.appendChild(o)},_encode:function(t){const s=t.length;let v=1;if(s<=17)v=1;else if(s<=32)v=2;else if(s<=53)v=3;else if(s<=78)v=4;else return null;const sz=17+v*4,m=[];for(let i=0;i<sz;i++){m[i]=[];for(let j=0;j<sz;j++)m[i][j]=0}this._addFinder(m,0,0);this._addFinder(m,sz-7,0);this._addFinder(m,0,sz-7);if(v>=2)this._addAlignment(m,sz);this._addTiming(m,sz);m[sz-8][8]=1;let bits='0100'+this._pad(s.toString(2),v>=2?16:8);for(let i=0;i<s;i++)bits+=this._pad(t.charCodeAt(i).toString(2),8);while(bits.length%8)bits+='0';const pads=['11101100','00010001'];while(bits.length<this._dataCap(v)*8){bits+=pads[(bits.length/8)%2]}let bi=0;for(let col=sz-1;col>0;col-=2){if(col===6)col=5;for(let r=0;r<sz;r++){const row=((Math.floor((sz-1-col)/2))%2===0)?r:sz-1-r;for(const c of[col,col-1]){if(c<0||c>=sz)continue;if(m[row][c]===0&&bi<bits.length){m[row][c]=bits[bi]==='1'?1:0;bi++}}}}this._applyMask(m,sz);return m},_addFinder:function(m,r,c){for(let i=-1;i<=7;i++)for(let j=-1;j<=7;j++){const ri=r+i,ci=c+j;if(ri<0||ci<0||ri>=m.length||ci>=m.length)continue;m[ri][ci]=(i>=0&&i<=6&&(j===0||j===6))||(j>=0&&j<=6&&(i===0||i===6))||(i>=2&&i<=4&&j>=2&&j<=4)?1:0}},_addAlignment:function(m,sz){const p=sz-7;for(let i=-2;i<=2;i++)for(let j=-2;j<=2;j++)m[p+i][p+j]=(Math.abs(i)===2||Math.abs(j)===2||(!i&&!j))?1:0},_addTiming:function(m,sz){for(let i=8;i<sz-8;i++){m[6][i]=m[6][i]||(i%2===0?1:0);m[i][6]=m[i][6]||(i%2===0?1:0)}},_applyMask:function(m,sz){for(let i=0;i<sz;i++)for(let j=0;j<sz;j++)if(this._isData(m,i,j,sz)&&((i+j)%2===0))m[i][j]=m[i][j]?0:1},_isData:function(m,r,c,sz){if(r<=8&&c<=8)return false;if(r<=8&&c>=sz-8)return false;if(r>=sz-8&&c<=8)return false;if(r===6||c===6)return false;return true},_pad:function(s,l){while(s.length<l)s='0'+s;return s},_dataCap:function(v){return[0,19,34,55,80][v]||19}};
    </script>
    <script src="/static/js/app.js"></script>
    <script src="/static/js/tutor.js"></script>
    <script src="/static/js/lessons.js"></script>
    <script src="/static/js/quiz.js"></script>
    <script src="/static/js/progress.js"></script>
    <script src="/static/js/gamification.js"></script>
    <script src="/static/js/generate.js"></script>
    <script src="/static/js/flashcards.js"></script>
    <script src="/static/js/timer.js"></script>
    <script src="/static/js/vocabulary.js"></script>
</body>
</html>
